import { Injectable } from '@angular/core';
import { Socket } from 'ngx-socket-io';

const WEBSOCKET_URL = 'http://localhost::3000';

export interface GeolocationData {
  // identifiant: number;
  latitude: number;
  longitude: number;
}
@Injectable({
  providedIn: 'root'
})
export class MarkerService {
  private data: any = [];
  public geolocations = this.socket.fromEvent<GeolocationData>('receive_geolocation');
  constructor(public socket: Socket ) {}

  // geolocations(data: any){
  //   return this.socket.fromEvent<any>('receive_geolocation');
  // }

  async generateIcon(data: any){
    const svg_contour =  btoa(`<path fill=\"$new_color\" d=\"M513.65,44.93c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23s352.82-188.17,352.82-529.23
    C866.47,202.9,708.5,44.93,513.65,44.93z\"/>
    <path fill=\"#03a9f4\" d=\"M813.63,619.72c-195.58-41.86-429.54-161.25-521.35-496.74c60.54-48.8,137.54-78.04,221.37-78.04
        c194.84,0,352.82,157.98,352.82,352.82C866.47,481.02,845.44,555.19,813.63,619.72z\"/>`);
    var svg = `<svg version="1.1" id="Calque_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">
    <style type="text/css">
        .st0{fill:#939598;fill-opacity:0;}
        .st1{opacity:0.0385;fill:#939598;enable-background:new    ;}
        .st2{opacity:0.0769;fill:#939598;enable-background:new    ;}
        .st3{opacity:0.1154;fill:#939598;enable-background:new    ;}
        .st4{opacity:0.1538;fill:#939598;enable-background:new    ;}
        .st5{opacity:0.1923;fill:#939598;enable-background:new    ;}
        .st6{opacity:0.2308;fill:#939598;enable-background:new    ;}
        .st7{opacity:0.2692;fill:#939598;enable-background:new    ;}
        .st8{opacity:0.3077;fill:#939598;enable-background:new    ;}
        .st9{opacity:0.3462;fill:#939598;enable-background:new    ;}
        .st10{opacity:0.3846;fill:#939598;enable-background:new    ;}
        .st11{opacity:0.4231;fill:#939598;enable-background:new    ;}
        .st12{opacity:0.4615;fill:#939598;enable-background:new    ;}
        .st13{opacity:0.5;fill:#939598;enable-background:new    ;}
        .st14{opacity:0.5385;fill:#939598;enable-background:new    ;}
        .st15{opacity:0.5769;fill:#939598;enable-background:new    ;}
        .st16{opacity:0.6154;fill:#939598;enable-background:new    ;}
        .st17{opacity:0.6538;fill:#939598;enable-background:new    ;}
        .st18{opacity:0.6923;fill:#939598;enable-background:new    ;}
        .st19{opacity:0.7308;fill:#939598;enable-background:new    ;}
        .st20{opacity:0.7692;fill:#939598;enable-background:new    ;}
        .st21{opacity:0.8077;fill:#939598;enable-background:new    ;}
        .st22{opacity:0.8462;fill:#939598;enable-background:new    ;}
        .st23{opacity:0.8846;fill:#939598;enable-background:new    ;}
        .st24{opacity:0.9231;fill:#939598;enable-background:new    ;}
        .st25{opacity:0.9615;fill:#939598;enable-background:new    ;}
        .st26{fill:#939598;}

        .st28{fill:url(#SVGID_1_);}
    </style>
    <g>
        <g>
            <path class="st0" d="M485.42,73.16c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C838.24,231.13,680.27,73.16,485.42,73.16z"/>
            <path class="st1" d="M486.51,72.07c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C839.33,230.04,681.36,72.07,486.51,72.07z"/>
            <path class="st2" d="M487.59,70.99c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C840.41,228.96,682.44,70.99,487.59,70.99z"/>
            <path class="st3" d="M488.68,69.9c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S841.5,763.78,841.5,422.72C841.5,227.87,683.53,69.9,488.68,69.9z"/>
            <path class="st4" d="M489.76,68.82c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S842.58,762.7,842.58,421.64C842.58,226.78,684.62,68.82,489.76,68.82z"/>
            <path class="st5" d="M490.85,67.73C296,67.73,138.03,225.7,138.03,420.55c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C843.67,225.7,685.7,67.73,490.85,67.73z"/>
            <path class="st6" d="M491.94,66.64c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C844.76,224.61,686.79,66.64,491.94,66.64z"/>
            <path class="st7" d="M493.02,65.56c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C845.84,223.53,687.87,65.56,493.02,65.56z"/>
            <path class="st8" d="M494.11,64.47c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C846.93,222.44,688.96,64.47,494.11,64.47z"/>
            <path class="st9" d="M495.19,63.39c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C848.01,221.36,690.04,63.39,495.19,63.39z"/>
            <path class="st10" d="M496.28,62.3c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S849.1,756.18,849.1,415.12C849.1,220.27,691.13,62.3,496.28,62.3z"/>
            <path class="st11" d="M497.36,61.22c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S850.18,755.1,850.18,414.04C850.18,219.19,692.21,61.22,497.36,61.22z"/>
            <path class="st12" d="M498.45,60.13c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C851.27,218.1,693.3,60.13,498.45,60.13z"/>
            <path class="st13" d="M499.53,59.05c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C852.35,217.01,694.39,59.05,499.53,59.05z"/>
            <path class="st14" d="M500.62,57.96c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C853.44,215.93,695.47,57.96,500.62,57.96z"/>
            <path class="st15" d="M501.71,56.87c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C854.53,214.84,696.56,56.87,501.71,56.87z"/>
            <path class="st16" d="M502.79,55.79c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C855.61,213.76,697.64,55.79,502.79,55.79z"/>
            <path class="st17" d="M503.88,54.7c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S856.7,748.58,856.7,407.52C856.7,212.67,698.73,54.7,503.88,54.7z"/>
            <path class="st18" d="M504.96,53.62c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S857.78,747.5,857.78,406.44C857.78,211.59,699.81,53.62,504.96,53.62z"/>
            <path class="st19" d="M506.05,52.53c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C858.87,210.5,700.9,52.53,506.05,52.53z"/>
            <path class="st20" d="M507.13,51.45c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C859.95,209.42,701.98,51.45,507.13,51.45z"/>
            <path class="st21" d="M508.22,50.36c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C861.04,208.33,703.07,50.36,508.22,50.36z"/>
            <path class="st22" d="M509.31,49.27c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C862.12,207.24,704.16,49.27,509.31,49.27z"/>
            <path class="st23" d="M510.39,48.19c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C863.21,206.16,705.24,48.19,510.39,48.19z"/>
            <path class="st24" d="M511.48,47.1c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S864.3,740.98,864.3,399.92C864.3,205.07,706.33,47.1,511.48,47.1z"/>
            <path class="st25" d="M512.56,46.02c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                S865.38,739.9,865.38,398.84C865.38,203.99,707.41,46.02,512.56,46.02z"/>
            <path class="st26" d="M513.65,44.93c-194.85,0-352.82,157.97-352.82,352.82c0,341.06,352.82,529.23,352.82,529.23
                s352.82-188.17,352.82-529.23C866.47,202.9,708.5,44.93,513.65,44.93z"/>
        </g>
            ${svg_contour}
        <g>

                <ellipse transform="matrix(0.7071 -0.7071 0.7071 0.7071 -159.039 468.0079)" class="st0" cx="485.42" cy="425.98" rx="282.26" ry="282.26"/>
            <circle class="st1" cx="486.51" cy="424.89" r="282.26"/>
            <circle class="st2" cx="487.59" cy="423.81" r="282.26"/>
            <circle class="st3" cx="488.68" cy="422.72" r="282.26"/>
            <circle class="st4" cx="489.76" cy="421.64" r="282.26"/>
            <circle class="st5" cx="490.85" cy="420.55" r="282.26"/>
            <circle class="st6" cx="491.94" cy="419.46" r="282.26"/>
            <circle class="st7" cx="493.02" cy="418.38" r="282.26"/>
            <circle class="st8" cx="494.11" cy="417.29" r="282.26"/>
            <circle class="st9" cx="495.19" cy="416.21" r="282.26"/>
            <ellipse class="st10" cx="496.27" cy="415.12" rx="282.26" ry="282.26"/>
            <circle class="st11" cx="497.36" cy="414.04" r="282.26"/>
            <circle class="st12" cx="498.45" cy="412.95" r="282.26"/>
            <circle class="st13" cx="499.53" cy="411.86" r="282.26"/>
            <circle class="st14" cx="500.62" cy="410.78" r="282.26"/>
            <circle class="st15" cx="501.71" cy="409.69" r="282.26"/>
            <circle class="st16" cx="502.79" cy="408.61" r="282.26"/>
            <circle class="st17" cx="503.88" cy="407.52" r="282.26"/>
            <circle class="st18" cx="504.96" cy="406.44" r="282.26"/>
            <circle class="st19" cx="506.05" cy="405.35" r="282.26"/>
            <ellipse class="st20" cx="507.13" cy="404.27" rx="282.26" ry="282.26"/>
            <circle class="st21" cx="508.22" cy="403.18" r="282.26"/>
            <circle class="st22" cx="509.31" cy="402.09" r="282.26"/>
            <circle class="st23" cx="510.39" cy="401.01" r="282.26"/>
            <circle class="st24" cx="511.48" cy="399.92" r="282.26"/>
            <circle class="st25" cx="512.56" cy="398.84" r="282.26"/>
            <circle class="st26" cx="513.65" cy="397.75" r="282.26"/>
        </g>

            <linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="1385.0031" y1="1088.603" x2="985.8271" y2="689.4271" gradientTransform="matrix(1 0 0 -1 -671.765 1286.765)">
            <stop  offset="0" style="stop-color:#FFFFFF"/>
            <stop  offset="0.448" style="stop-color:#FCFCFC"/>
            <stop  offset="0.7174" style="stop-color:#F4F4F4"/>
            <stop  offset="0.9388" style="stop-color:#E6E6E6"/>
            <stop  offset="1" style="stop-color:#E0E0E0"/>
        </linearGradient>
        <circle class="st28" cx="513.65" cy="397.75" r="282.26"/>
    </g>
    </svg>`;
    // const myIcon: any = "data:image/svg+xml;base64," + Buffer.from(svg).toString('base64');
    return "data:image/svg+xml;base64," + btoa(svg);

  }
}

